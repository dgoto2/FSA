<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute and view possible differences between paired sets of ages. — ageBias • FSA</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute and view possible differences between paired sets of ages. — ageBias" />
<meta property="og:description" content="Constructs age-agreement tables, statistical tests to detect differences, and plots to visualize potential differences in paired age estimates. Ages may be from, for example, two readers of the same structure, one reader at two times, two structures (e.g., scales, spines, otoliths), or one structure and known ages." />
<meta property="og:image" content="http://derekogle.com/FSA/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FSA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/droglenc/FSA">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute and view possible differences between paired sets of ages.</h1>
    <small class="dont-index">Source: <a href='https://github.com/droglenc/FSA/blob/master/R/ageComparisons.R'><code>R/ageComparisons.R</code></a></small>
    <div class="hidden name"><code>ageBias.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Constructs age-agreement tables, statistical tests to detect differences, and plots to visualize potential differences in paired age estimates. Ages may be from, for example, two readers of the same structure, one reader at two times, two structures (e.g., scales, spines, otoliths), or one structure and known ages.</p>
    </div>

    <pre class="usage"><span class='fu'>ageBias</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  <span class='va'>data</span>,
  ref.lab <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>$</span><span class='va'>Enames</span>,
  nref.lab <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>$</span><span class='va'>Rname</span>,
  method <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust.methods</a></span>,
  sig.level <span class='op'>=</span> <span class='fl'>0.05</span>,
  min.n.CI <span class='op'>=</span> <span class='fl'>3</span>
<span class='op'>)</span>

<span class='co'># S3 method for ageBias</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  what <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"table"</span>, <span class='st'>"symmetry"</span>, <span class='st'>"Bowker"</span>, <span class='st'>"EvansHoenig"</span>, <span class='st'>"McNemar"</span>, <span class='st'>"bias"</span>,
    <span class='st'>"diff.bias"</span>, <span class='st'>"n"</span><span class='op'>)</span>,
  flip.table <span class='op'>=</span> <span class='cn'>FALSE</span>,
  zero.print <span class='op'>=</span> <span class='st'>"-"</span>,
  digits <span class='op'>=</span> <span class='fl'>3</span>,
  cont.corr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"none"</span>, <span class='st'>"Yates"</span>, <span class='st'>"Edwards"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for ageBias</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  xvals <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"reference"</span>, <span class='st'>"mean"</span><span class='op'>)</span>,
  xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>xvals</span> <span class='op'>==</span> <span class='st'>"reference"</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>ref.lab</span>, <span class='st'>"Mean Age"</span><span class='op'>)</span>,
  ylab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>nref.lab</span>, <span class='st'>"-"</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>ref.lab</span><span class='op'>)</span>,
  xlim <span class='op'>=</span> <span class='cn'>NULL</span>,
  ylim <span class='op'>=</span> <span class='cn'>NULL</span>,
  yaxt <span class='op'>=</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='st'>"yaxt"</span><span class='op'>)</span>,
  xaxt <span class='op'>=</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='st'>"xaxt"</span><span class='op'>)</span>,
  col.agree <span class='op'>=</span> <span class='st'>"gray60"</span>,
  lwd.agree <span class='op'>=</span> <span class='va'>lwd</span>,
  lty.agree <span class='op'>=</span> <span class='fl'>2</span>,
  lwd <span class='op'>=</span> <span class='fl'>1</span>,
  sfrac <span class='op'>=</span> <span class='fl'>0</span>,
  show.pts <span class='op'>=</span> <span class='cn'>NULL</span>,
  pch.pts <span class='op'>=</span> <span class='fl'>20</span>,
  cex.pts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>xHist</span> <span class='op'>|</span> <span class='va'>yHist</span>, <span class='fl'>1.5</span>, <span class='fl'>1</span><span class='op'>)</span>,
  col.pts <span class='op'>=</span> <span class='st'>"black"</span>,
  transparency <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>10</span>,
  show.CI <span class='op'>=</span> <span class='cn'>FALSE</span>,
  col.CI <span class='op'>=</span> <span class='st'>"black"</span>,
  col.CIsig <span class='op'>=</span> <span class='st'>"red"</span>,
  lwd.CI <span class='op'>=</span> <span class='va'>lwd</span>,
  sfrac.CI <span class='op'>=</span> <span class='va'>sfrac</span>,
  show.range <span class='op'>=</span> <span class='cn'>NULL</span>,
  col.range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>show.CI</span>, <span class='st'>"gray70"</span>, <span class='st'>"black"</span><span class='op'>)</span>,
  lwd.range <span class='op'>=</span> <span class='va'>lwd</span>,
  sfrac.range <span class='op'>=</span> <span class='va'>sfrac</span>,
  pch.mean <span class='op'>=</span> <span class='fl'>19</span>,
  pch.mean.sig <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>show.CI</span> <span class='op'>|</span> <span class='va'>show.range</span>, <span class='fl'>21</span>, <span class='fl'>19</span><span class='op'>)</span>,
  cex.mean <span class='op'>=</span> <span class='va'>lwd</span>,
  yHist <span class='op'>=</span> <span class='cn'>TRUE</span>,
  xHist <span class='op'>=</span> <span class='cn'>NULL</span>,
  hist.panel.size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>7</span>,
  col.hist <span class='op'>=</span> <span class='st'>"gray90"</span>,
  allowAdd <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A formula of the form <code>nrefvar~refvar</code>, where <code>nrefvar</code> and <code>refvar</code> generically represent variables that contain the paired &#8220;nonreference&#8221; and &#8220;reference&#8221; age estimates, respectively. See details.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame that minimally contains the paired age estimates given in <code>formula</code>.</p></td>
    </tr>
    <tr>
      <th>ref.lab</th>
      <td><p>A string label for the reference age estimates.</p></td>
    </tr>
    <tr>
      <th>nref.lab</th>
      <td><p>A string label for the nonreference age estimates.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A string for which method to use to adjust p-values for multiple comparisons. See <code><a href='https://rdrr.io/r/stats/p.adjust.html'>?p.adjust.methods</a></code>.</p></td>
    </tr>
    <tr>
      <th>sig.level</th>
      <td><p>A numeric value to determine whether a p-value indicates a significant result. The confidence level used in <code>plot</code> is 100*(1-<code>sig.level</code>).</p></td>
    </tr>
    <tr>
      <th>min.n.CI</th>
      <td><p>A numeric value (default is 3) that is the smallest sample size for which a confidence interval will be computed.</p></td>
    </tr>
    <tr>
      <th>what</th>
      <td><p>A string that indicates what type of summary to print or plot to construct. See details.</p></td>
    </tr>
    <tr>
      <th>flip.table</th>
      <td><p>A logical that indicates whether the age-agreement table should be &#8216;flipped&#8217; (i.e., rows are reversed so that younger ages are at the bottom of the table). This makes the table more directly comparable to the age bias plot.</p></td>
    </tr>
    <tr>
      <th>zero.print</th>
      <td><p>A string for what should be printed in place of the zeros on an age-agreement table. The default is to print a single dash.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>A numeric for the minimum number of digits to print when showing <code>what="bias"</code> or <code>what="diff.bias"</code> in <code>summary</code>.</p></td>
    </tr>
    <tr>
      <th>cont.corr</th>
      <td><p>A string that indicates the continuity correction method to be used with (only) McNemar test. If <code>"none"</code> (default) then no continuity correction is used, if <code>"Yates"</code> then 0.5 is used, and if <code>"Edwards"</code> then 1 is used.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for methods.</p></td>
    </tr>
    <tr>
      <th>x, object</th>
      <td><p>An object of class <code>ageBias</code>, usually a result from <code>ageBias</code>.</p></td>
    </tr>
    <tr>
      <th>xvals</th>
      <td><p>A string for whether the x-axis values are reference ages or mean of the reference and nonreference ages.</p></td>
    </tr>
    <tr>
      <th>xlab, ylab</th>
      <td><p>A string label for the x-axis (reference) or y-axis (non-reference) age estimates, respectively.</p></td>
    </tr>
    <tr>
      <th>xlim, ylim</th>
      <td><p>A numeric vector of length 2 that contains the limits of the x-axis (reference ages) or y-axis (non-reference ages), respectively.</p></td>
    </tr>
    <tr>
      <th>xaxt, yaxt</th>
      <td><p>A string which specifies the x- and y-axis types. Specifying &#8220;n&#8221; suppresses plotting of the axis. See <code><a href='https://rdrr.io/r/graphics/par.html'>?par</a></code>.</p></td>
    </tr>
    <tr>
      <th>col.agree</th>
      <td><p>A string or numeric for the color of the 1:1 or zero (if <code>difference=TRUE</code>) reference line.</p></td>
    </tr>
    <tr>
      <th>lwd.agree</th>
      <td><p>A numeric for the line width of the 1:1 or zero (if <code>difference=TRUE</code>) reference line.</p></td>
    </tr>
    <tr>
      <th>lty.agree</th>
      <td><p>A numeric for the line type of the 1:1 or zero (if <code>difference=TRUE</code>) reference line.</p></td>
    </tr>
    <tr>
      <th>lwd</th>
      <td><p>A numeric that controls the separate &#8216;lwd&#8217; argument (e.g., <code>lwd.CI</code> and <code>lwd.range</code>).</p></td>
    </tr>
    <tr>
      <th>sfrac</th>
      <td><p>A numeric that controls the separate &#8216;sfrac&#8217; arguments (e.g., <code>sfrac.CI</code> and <code>sfrac.range</code>). See <code>sfrac</code> in <code><a href='https://rdrr.io/pkg/plotrix/man/plotCI.html'>plotCI</a></code> of <span class="pkg">plotrix</span>.</p></td>
    </tr>
    <tr>
      <th>show.pts</th>
      <td><p>A logical for whether or not the raw data points are plotted.</p></td>
    </tr>
    <tr>
      <th>pch.pts</th>
      <td><p>A numeric for the plotting character of the raw data points.</p></td>
    </tr>
    <tr>
      <th>cex.pts</th>
      <td><p>A character expansion value for the size of the symbols for <code>pch.pts</code>.</p></td>
    </tr>
    <tr>
      <th>col.pts</th>
      <td><p>A string or numeric for the color of the raw data points. The default is to use black with the transparency found in <code>transparency</code>.</p></td>
    </tr>
    <tr>
      <th>transparency</th>
      <td><p>A numeric (between 0 and 1) for the level of transparency of the raw data points. This number of points plotted on top of each other will represent the color in <code>col.pts</code>.</p></td>
    </tr>
    <tr>
      <th>show.CI</th>
      <td><p>A logical for whether confidence intervals should be plotted or not.</p></td>
    </tr>
    <tr>
      <th>col.CI</th>
      <td><p>A string or numeric for the color of confidence interval bars that are considered non-significant.</p></td>
    </tr>
    <tr>
      <th>col.CIsig</th>
      <td><p>A string or numeric for the color of confidence interval bars that are considered significant.</p></td>
    </tr>
    <tr>
      <th>lwd.CI</th>
      <td><p>A numeric for the line width of the confidence interval bars.</p></td>
    </tr>
    <tr>
      <th>sfrac.CI</th>
      <td><p>A numeric for the size of the ends of the confidence interval bars. See <code>sfrac</code> in <code><a href='https://rdrr.io/pkg/plotrix/man/plotCI.html'>plotCI</a></code> of <span class="pkg">plotrix</span>.</p></td>
    </tr>
    <tr>
      <th>show.range</th>
      <td><p>A logical for whether or not vertical bars that represent the range of the data points are plotted.</p></td>
    </tr>
    <tr>
      <th>col.range</th>
      <td><p>A string or numeric for the color of the range intervals.</p></td>
    </tr>
    <tr>
      <th>lwd.range</th>
      <td><p>A numeric for the line width of the range intervals.</p></td>
    </tr>
    <tr>
      <th>sfrac.range</th>
      <td><p>A numeric for the size of the ends of the range intervals. See <code>sfrac</code> in <code><a href='https://rdrr.io/pkg/plotrix/man/plotCI.html'>plotCI</a></code> of <span class="pkg">plotrix</span>.</p></td>
    </tr>
    <tr>
      <th>pch.mean</th>
      <td><p>A numeric for the plotting character used for the mean values when the means are considered insignificant.</p></td>
    </tr>
    <tr>
      <th>pch.mean.sig</th>
      <td><p>A numeric for the plotting character for the mean values when the means are considered significant.</p></td>
    </tr>
    <tr>
      <th>cex.mean</th>
      <td><p>A character expansion value for the size of the mean symbol in <code>pch.mean</code> and <code>pch.mean.sig</code>.</p></td>
    </tr>
    <tr>
      <th>yHist</th>
      <td><p>A logical for whether a histogram of the y-axis variable should be added to the right margin of the age bias plot. See details.</p></td>
    </tr>
    <tr>
      <th>xHist</th>
      <td><p>A logical for whether a histogram of the x-axis variable should be added to the top margin of the age bias plot. See details.</p></td>
    </tr>
    <tr>
      <th>hist.panel.size</th>
      <td><p>A numeric between 0 and 1 that indicates the proportional size of histograms (relative to the entire plotting pane) in the plot margins (only used if <code>xHist=TRUE</code> or <code>yHist=TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>col.hist</th>
      <td><p>A string for the color of the bars in the marginal histograms (only used if <code>xHist=TRUE</code> or <code>yHist=TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>allowAdd</th>
      <td><p>A logical that will allow the user to add items to the main (i.e., not the marginal histograms) plot panel (if <code>TRUE</code>). Defaults to <code>FALSE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>ageBias</code> returns a list with the following items:</p><ul>
<li><p>data A data.frame with the original paired age estimates and the difference between those estimates.</p></li>
<li><p>agree The age-agreement table.</p></li>
<li><p>bias A data.frame that contains the bias statistics.</p></li>
<li><p>bias.diff A data.frame that contains the bias statistics for the differences.</p></li>
<li><p>ref.lab A string that contains an optional label for the age estimates in the columns (reference) of the age-agreement table.</p></li>
<li><p>nref.lab A string that contains an optional label for the age estimates in the rows (non-reference) of the age-agreement table.</p></li>
</ul>

<p><code>summary</code> returns the result if <code>what=</code> contains one item, otherwise it returns nothing. Nothing is returned by <code>plot</code> or <code>plotAB</code>, but see details for a description of the plot that is produced.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Generally, one of the two age estimates will be identified as the &#8220;reference&#8221; set. In some cases this may be the true ages, the ages from the more experienced reader, the ages from the first reading, or the ages from the structure generally thought to provide the most accurate results. In other cases, such as when comparing two novice readers, the choice may be arbitrary. The reference ages will form the columns of the age-agreement table and will be the &#8220;constant&#8221; age used in the t-tests and age bias plots (i.e., the x-axis). See further details below.</p>
<p>The age-agreement table is constructed with  <code>what="table"</code> in <code>summary</code>. The agreement table can be &#8220;flipped&#8221; (i.e., the rows in descending rather than ascending order) with <code>flip.table=TRUE</code>. By default, the tables are shown with zeros replaced by dashes. This behavior can be changed with <code>zero.print</code>.</p>
<p>Three statistical tests of symmetry for the age-agreement table can be computed with <code>what=</code> in <code>summary</code>. The &#8220;unpooled&#8221; or Bowker test as described in Hoenig <em>et al.</em> (1995) is constructed with <code>what="Bowker"</code>, the &#8220;semi-pooled&#8221; or Evans-Hoenig test as described in Evans and Hoenig (1998) is constructed with <code>what="EvansHoenig"</code>, and the &#8220;pooled&#8221; or McNemar test as described in Evans and Hoenig (1998) is constructed with <code>what="McNemar"</code>. All three tests are computed with <code>what="symmetry"</code>.</p>
<p>The age bias plot introduced by Campana <em>et al.</em> (1995) can be constructed with <code><a href='plotAB.html'>plotAB</a></code>. Muir <em>et al.</em> (2008) modified the original age bias plot by plotting the difference between the two ages on the y-axis (still against a reference age on the x-axis). McBride (2015) introduced the Bland-Altman plot for comparing fish ages where the difference in ages is plotted on the y-axis versus the mean of the ages on the x-axis. Modifications of these plots are created with <code>plot</code> (rather than <code><a href='plotAB.html'>plotAB</a></code>) using <code>xvals=</code> to control what is plotted on the x-axis (i.e., <code>xvals="reference"</code> uses the reference ages, whereas <code>xvals="mean"</code> uses the mean of the two ages for the x-axis). In both plots, a horizontal agreement line at a difference of zero is shown for comparative purposes. In addition, a histogram of the differences is shown in the right margin (can be excluded with <code>yHist=FALSE</code>.) A histogram of the reference ages is shown by default in the top margin for the modified age bias plot, but not for the modified Bland-Altman-like plot (the presence of this histogram is controlled with <code>xHist=</code>).</p>
<p>By default, the modified age bias plot shows the mean and range for the nonreference ages at each of the reference ages. Means shown with an open dot are mean age differences that are significantly different from zero. The ranges of differences in ages at each reference age can be removed with <code>show.range=FALSE</code>. A confidence interval for difference in ages can be added with <code>show.CI=FALSE</code>. Confidence intervals are only shown if the sample size is greater than the value in <code>min.n.CI=</code> (also from the original call to <code>ageBias</code>). Confidence intervals plotted in red with an open dot (by default; these can be changed with <code>col.CIsig</code> and <code>pch.mean.sig</code>, respectively) do not contain the reference age (see discussion of t-tests below). Individual points are plotted if <code>show.pts=TRUE</code>, where there color is controlled by <code>col.pts=</code> and <code>transparency=</code>. See examples for use of these arguments.</p>
<p>The main (i.e., not the marginal histograms) can be "added to" after the plot is constructed if <code>allowAdd=TRUE</code> is used. For example, the Bland-Altman-like plot can be augmented with a horizontal line at the mean difference in ages, a line for the regression between the differences and the means, or a generalized additive model that describes the relationship between the differences and the means. See the examples for use of <code>allowAdd=TRUE</code>. It is recommended to save the plotting parameters (e.g., <code>op &lt;- par(no.readonly=TRUE)</code>) before using <code>plot</code> with <code>allowAdd=TRUE</code> so that the original parameters can be reset (e.g., <code><a href='https://rdrr.io/r/graphics/par.html'>par(op)</a></code>); see the examples.</p>
<p>Individual t-tests to determine if the mean age of the nonreference set at a particular age of the reference set is equal to the reference age (e.g., is the mean age of the nonreference set at age-3 of the reference set statistically different from 3?) are shown with <code>what="bias"</code> in <code>summary</code>. The results provide a column that indicates whether the difference is significant or not as determined by adjusted p-values from the t-tests and using the significance level provided in <code>sig.level</code> (defaults to 0.05). Similar results for the difference in ages (e.g., is the mean reference age minus nonreference age at a nonreference age of 3 different from 0?) are constructed with <code>what="diff.bias"</code> in <code>summary</code>.</p>
<p>The sample size present in the age-agreement table is found with <code>what="n"</code>.</p>
    <h2 class="hasAnchor" id="testing"><a class="anchor" href="#testing"></a>Testing</h2>

    <p>Tested all symmetry test results against results in Evans and Hoenig (2008), the McNemar and Evans-Hoenig results against results from <code><a href='https://rdrr.io/pkg/fishmethods/man/compare2.html'>compare2</a></code> in <span class="pkg">fishmethods</span>, and all results using the <code><a href='https://rdrr.io/pkg/FSAdata/man/AlewifeLH.html'>AlewifeLH</a></code> data set from <span class="pkg">FSAdata</span> against results from the online resource at http://www.nefsc.noaa.gov/fbp/age-prec/.</p>
    <h2 class="hasAnchor" id="ifar-chapter"><a class="anchor" href="#ifar-chapter"></a>IFAR Chapter</h2>

    <p>4-Age Comparisons. <b>Note that <code>plot</code> has changed since IFAR was published. Some of the original functionality is in <code><a href='plotAB.html'>plotAB</a></code>.</b></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ogle, D.H. 2016. <a href='http://derekogle.com/IFAR/'>Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Campana, S.E., M.C. Annand, and J.I. McMillan. 1995. Graphical and statistical methods for determining the consistency of age determinations. Transactions of the American Fisheries Society 124:131-138. [Was (is?) available from http://www.bio.gc.ca/otoliths/documents/Campana%20et%20al%201995%20TAFS.pdf.]</p>
<p>Evans, G.T. and J.M. Hoenig. 1998. Testing and viewing symmetry in contingency tables, with application to readers of fish ages. Biometrics 54:620-629.</p>
<p>Hoenig, J.M., M.J. Morgan, and C.A. Brown. 1995. Analysing differences between two age determination methods by tests of symmetry. Canadian Journal of Fisheries and Aquatic Sciences 52:364-368.</p>
<p>McBride, R.S. 2015. Diagnosis of paired age agreement: A simulation approach of accuracy and precision effects. ICES Journal of Marine Science 72:2149-2167.</p>
<p>Muir, A.M., M.P. Ebener, J.X. He, and J.E. Johnson. 2008. A comparison of the scale and otolith methods of age estimation for lake whitefish in Lake Huron. North American Journal of Fisheries Management 28:625-635. [Was (is?) available from http://www.tandfonline.com/doi/abs/10.1577/M06-160.1]</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See <code><a href='agePrecision.html'>agePrecision</a></code> for measures of precision between pairs of age estimates. See <code><a href='https://rdrr.io/pkg/fishmethods/man/compare2.html'>compare2</a></code> in <span class="pkg">fishmethods</span> for similar functionality. See <code><a href='plotAB.html'>plotAB</a></code> for a more traditional age-bias plot.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Derek H. Ogle, <a href='mailto:derek@derekogle.com'>derek@derekogle.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>ab1</span> <span class='op'>&lt;-</span> <span class='fu'>ageBias</span><span class='op'>(</span><span class='va'>scaleC</span><span class='op'>~</span><span class='va'>otolithC</span>,data<span class='op'>=</span><span class='va'>WhitefishLC</span>,
               ref.lab<span class='op'>=</span><span class='st'>"Otolith Age"</span>,nref.lab<span class='op'>=</span><span class='st'>"Scale Age"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Sample size in the age agreement table is 151.
#&gt; 
#&gt; Summary of Scale Age by Otolith Age 
#&gt;  otolithC  n min max  mean    SE       t   adj.p   sig    LCI   UCI
#&gt;         1  9   1   2  1.44 0.176   2.530 0.28212 FALSE  1.039  1.85
#&gt;         2  7   1   5  2.00 0.577   0.000 1.00000 FALSE  0.587  3.41
#&gt;         3 17   1   6  3.35 0.242   1.461 0.81743 FALSE  2.841  3.87
#&gt;         4 18   2   6  3.83 0.232  -0.718 1.00000 FALSE  3.343  4.32
#&gt;         5  8   4   8  5.25 0.491   0.509 1.00000 FALSE  4.089  6.41
#&gt;         6 10   3   6  4.60 0.267  -5.250 0.00686  TRUE  3.997  5.20
#&gt;         7  9   5  10  6.44 0.556  -1.000 1.00000 FALSE  5.163  7.73
#&gt;         8 12   5   8  6.08 0.288  -6.665 0.00053  TRUE  5.450  6.72
#&gt;         9 10   6   8  7.20 0.200  -9.000 0.00014  TRUE  6.748  7.65
#&gt;        10  9   6   8  7.11 0.261 -11.086 0.00007  TRUE  6.510  7.71
#&gt;        11  8   5   9  7.25 0.453  -8.275 0.00103  TRUE  6.178  8.32
#&gt;        12  7   6  12  8.43 0.782  -4.564 0.04600  TRUE  6.514 10.34
#&gt;        13  7   6  13  8.86 1.010  -4.101 0.06349 FALSE  6.385 11.33
#&gt;        14  3   6  13  8.67 2.186  -2.440 0.80891 FALSE -0.738 18.07
#&gt;        15  5   9  14 11.00 0.949  -4.216 0.12165 FALSE  8.366 13.63
#&gt;        16  4  10  15 12.50 1.041  -3.363 0.30552 FALSE  9.188 15.81
#&gt;        17  4   9  13 11.00 0.816  -7.348 0.05729 FALSE  8.402 13.60
#&gt;        18  2   7  13 10.00    NA      NA      NA FALSE     NA    NA
#&gt;        19  1  14  14 14.00    NA      NA      NA FALSE     NA    NA
#&gt;        23  1  10  10 10.00    NA      NA      NA FALSE     NA    NA
#&gt; 
#&gt; Summary of Scale Age-Otolith Age by Otolith Age
#&gt;  otolithC  n min max    mean    SE       t   adj.p   sig      LCI    UCI
#&gt;         1  9   0   1   0.444 0.176   2.530 0.28212 FALSE   0.0393  0.850
#&gt;         2  7  -1   3   0.000 0.577   0.000 1.00000 FALSE  -1.4127  1.413
#&gt;         3 17  -2   3   0.353 0.242   1.461 0.81743 FALSE  -0.1593  0.865
#&gt;         4 18  -2   2  -0.167 0.232  -0.718 1.00000 FALSE  -0.6566  0.323
#&gt;         5  8  -1   3   0.250 0.491   0.509 1.00000 FALSE  -0.9110  1.411
#&gt;         6 10  -3   0  -1.400 0.267  -5.250 0.00686  TRUE  -2.0032 -0.797
#&gt;         7  9  -2   3  -0.556 0.556  -1.000 1.00000 FALSE  -1.8367  0.726
#&gt;         8 12  -3   0  -1.917 0.288  -6.665 0.00053  TRUE  -2.5496 -1.284
#&gt;         9 10  -3  -1  -1.800 0.200  -9.000 0.00014  TRUE  -2.2524 -1.348
#&gt;        10  9  -4  -2  -2.889 0.261 -11.086 0.00007  TRUE  -3.4898 -2.288
#&gt;        11  8  -6  -2  -3.750 0.453  -8.275 0.00103  TRUE  -4.8216 -2.678
#&gt;        12  7  -6   0  -3.571 0.782  -4.564 0.04600  TRUE  -5.4860 -1.657
#&gt;        13  7  -7   0  -4.143 1.010  -4.101 0.06349 FALSE  -6.6146 -1.671
#&gt;        14  3  -8  -1  -5.333 2.186  -2.440 0.80891 FALSE -14.7381  4.071
#&gt;        15  5  -6  -1  -4.000 0.949  -4.216 0.12165 FALSE  -6.6340 -1.366
#&gt;        16  4  -6  -1  -3.500 1.041  -3.363 0.30552 FALSE  -6.8124 -0.188
#&gt;        17  4  -8  -4  -6.000 0.816  -7.348 0.05729 FALSE  -8.5985 -3.402
#&gt;        18  2 -11  -5  -8.000    NA      NA      NA FALSE       NA     NA
#&gt;        19  1  -5  -5  -5.000    NA      NA      NA FALSE       NA     NA
#&gt;        23  1 -13 -13 -13.000    NA      NA      NA FALSE       NA     NA
#&gt; 
#&gt; Raw agreement table (square)
#&gt;          Otolith Age
#&gt; Scale Age  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
#&gt;        1   5  4  1  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        2   4  1  -  1  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        3   -  1 10  6  -  1  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        4   -  -  5  7  3  3  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        5   -  1  -  3  2  5  3  4  -  -  1  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        6   -  -  1  1  2  1  3  4  1  2  1  1  2  1  -  -  -  -  -  -  -  -  -
#&gt;        7   -  -  -  -  -  -  1  3  6  4  2  2  1  1  -  -  -  1  -  -  -  -  -
#&gt;        8   -  -  -  -  1  -  1  1  3  3  3  1  -  -  -  -  -  -  -  -  -  -  -
#&gt;        9   -  -  -  -  -  -  -  -  -  -  1  1  1  -  2  -  1  -  -  -  -  -  -
#&gt;        10  -  -  -  -  -  -  1  -  -  -  -  1  1  -  -  1  -  -  -  -  -  -  1
#&gt;        11  -  -  -  -  -  -  -  -  -  -  -  -  1  -  1  -  2  -  -  -  -  -  -
#&gt;        12  -  -  -  -  -  -  -  -  -  -  -  1  -  -  1  1  -  -  -  -  -  -  -
#&gt;        13  -  -  -  -  -  -  -  -  -  -  -  -  1  1  -  1  1  1  -  -  -  -  -
#&gt;        14  -  -  -  -  -  -  -  -  -  -  -  -  -  -  1  -  -  -  1  -  -  -  -
#&gt;        15  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  1  -  -  -  -  -  -  -
#&gt;        16  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        17  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        18  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        19  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        20  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        21  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        22  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        23  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt; 
#&gt; Age agreement table symmetry test results
#&gt;       symTest df   chi.sq            p
#&gt; 1     McNemar  1 51.57851 6.879037e-13
#&gt; 2 EvansHoenig 10 62.46849 1.232555e-09
#&gt; 3      Bowker 54 75.97662 2.598188e-02</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"symmetry"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       symTest df   chi.sq            p
#&gt; 1     McNemar  1 51.57851 6.879037e-13
#&gt; 2 EvansHoenig 10 62.46849 1.232555e-09
#&gt; 3      Bowker 54 75.97662 2.598188e-02</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"Bowker"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   symTest df   chi.sq          p
#&gt; 3  Bowker 54 75.97662 0.02598188</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"EvansHoenig"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       symTest df   chi.sq            p
#&gt; 2 EvansHoenig 10 62.46849 1.232555e-09</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"McNemar"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   symTest df   chi.sq            p
#&gt; 1 McNemar  1 51.57851 6.879037e-13</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"McNemar"</span>,cont.corr<span class='op'>=</span><span class='st'>"Yates"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                      symTest df   chi.sq            p
#&gt; 1 McNemar (Yates Correction)  1 50.92769 9.583228e-13</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"bias"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  otolithC  n min max  mean    SE       t   adj.p   sig    LCI   UCI
#&gt;         1  9   1   2  1.44 0.176   2.530 0.28212 FALSE  1.039  1.85
#&gt;         2  7   1   5  2.00 0.577   0.000 1.00000 FALSE  0.587  3.41
#&gt;         3 17   1   6  3.35 0.242   1.461 0.81743 FALSE  2.841  3.87
#&gt;         4 18   2   6  3.83 0.232  -0.718 1.00000 FALSE  3.343  4.32
#&gt;         5  8   4   8  5.25 0.491   0.509 1.00000 FALSE  4.089  6.41
#&gt;         6 10   3   6  4.60 0.267  -5.250 0.00686  TRUE  3.997  5.20
#&gt;         7  9   5  10  6.44 0.556  -1.000 1.00000 FALSE  5.163  7.73
#&gt;         8 12   5   8  6.08 0.288  -6.665 0.00053  TRUE  5.450  6.72
#&gt;         9 10   6   8  7.20 0.200  -9.000 0.00014  TRUE  6.748  7.65
#&gt;        10  9   6   8  7.11 0.261 -11.086 0.00007  TRUE  6.510  7.71
#&gt;        11  8   5   9  7.25 0.453  -8.275 0.00103  TRUE  6.178  8.32
#&gt;        12  7   6  12  8.43 0.782  -4.564 0.04600  TRUE  6.514 10.34
#&gt;        13  7   6  13  8.86 1.010  -4.101 0.06349 FALSE  6.385 11.33
#&gt;        14  3   6  13  8.67 2.186  -2.440 0.80891 FALSE -0.738 18.07
#&gt;        15  5   9  14 11.00 0.949  -4.216 0.12165 FALSE  8.366 13.63
#&gt;        16  4  10  15 12.50 1.041  -3.363 0.30552 FALSE  9.188 15.81
#&gt;        17  4   9  13 11.00 0.816  -7.348 0.05729 FALSE  8.402 13.60
#&gt;        18  2   7  13 10.00    NA      NA      NA FALSE     NA    NA
#&gt;        19  1  14  14 14.00    NA      NA      NA FALSE     NA    NA
#&gt;        23  1  10  10 10.00    NA      NA      NA FALSE     NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"diff.bias"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  otolithC  n min max    mean    SE       t   adj.p   sig      LCI    UCI
#&gt;         1  9   0   1   0.444 0.176   2.530 0.28212 FALSE   0.0393  0.850
#&gt;         2  7  -1   3   0.000 0.577   0.000 1.00000 FALSE  -1.4127  1.413
#&gt;         3 17  -2   3   0.353 0.242   1.461 0.81743 FALSE  -0.1593  0.865
#&gt;         4 18  -2   2  -0.167 0.232  -0.718 1.00000 FALSE  -0.6566  0.323
#&gt;         5  8  -1   3   0.250 0.491   0.509 1.00000 FALSE  -0.9110  1.411
#&gt;         6 10  -3   0  -1.400 0.267  -5.250 0.00686  TRUE  -2.0032 -0.797
#&gt;         7  9  -2   3  -0.556 0.556  -1.000 1.00000 FALSE  -1.8367  0.726
#&gt;         8 12  -3   0  -1.917 0.288  -6.665 0.00053  TRUE  -2.5496 -1.284
#&gt;         9 10  -3  -1  -1.800 0.200  -9.000 0.00014  TRUE  -2.2524 -1.348
#&gt;        10  9  -4  -2  -2.889 0.261 -11.086 0.00007  TRUE  -3.4898 -2.288
#&gt;        11  8  -6  -2  -3.750 0.453  -8.275 0.00103  TRUE  -4.8216 -2.678
#&gt;        12  7  -6   0  -3.571 0.782  -4.564 0.04600  TRUE  -5.4860 -1.657
#&gt;        13  7  -7   0  -4.143 1.010  -4.101 0.06349 FALSE  -6.6146 -1.671
#&gt;        14  3  -8  -1  -5.333 2.186  -2.440 0.80891 FALSE -14.7381  4.071
#&gt;        15  5  -6  -1  -4.000 0.949  -4.216 0.12165 FALSE  -6.6340 -1.366
#&gt;        16  4  -6  -1  -3.500 1.041  -3.363 0.30552 FALSE  -6.8124 -0.188
#&gt;        17  4  -8  -4  -6.000 0.816  -7.348 0.05729 FALSE  -8.5985 -3.402
#&gt;        18  2 -11  -5  -8.000    NA      NA      NA FALSE       NA     NA
#&gt;        19  1  -5  -5  -5.000    NA      NA      NA FALSE       NA     NA
#&gt;        23  1 -13 -13 -13.000    NA      NA      NA FALSE       NA     NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Sample size in the age agreement table is 151.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"n"</span>,<span class='st'>"symmetry"</span>,<span class='st'>"table"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Sample size in the age agreement table is 151.
#&gt; 
#&gt; Raw agreement table (square)
#&gt;          Otolith Age
#&gt; Scale Age  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
#&gt;        1   5  4  1  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        2   4  1  -  1  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        3   -  1 10  6  -  1  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        4   -  -  5  7  3  3  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        5   -  1  -  3  2  5  3  4  -  -  1  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        6   -  -  1  1  2  1  3  4  1  2  1  1  2  1  -  -  -  -  -  -  -  -  -
#&gt;        7   -  -  -  -  -  -  1  3  6  4  2  2  1  1  -  -  -  1  -  -  -  -  -
#&gt;        8   -  -  -  -  1  -  1  1  3  3  3  1  -  -  -  -  -  -  -  -  -  -  -
#&gt;        9   -  -  -  -  -  -  -  -  -  -  1  1  1  -  2  -  1  -  -  -  -  -  -
#&gt;        10  -  -  -  -  -  -  1  -  -  -  -  1  1  -  -  1  -  -  -  -  -  -  1
#&gt;        11  -  -  -  -  -  -  -  -  -  -  -  -  1  -  1  -  2  -  -  -  -  -  -
#&gt;        12  -  -  -  -  -  -  -  -  -  -  -  1  -  -  1  1  -  -  -  -  -  -  -
#&gt;        13  -  -  -  -  -  -  -  -  -  -  -  -  1  1  -  1  1  1  -  -  -  -  -
#&gt;        14  -  -  -  -  -  -  -  -  -  -  -  -  -  -  1  -  -  -  1  -  -  -  -
#&gt;        15  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  1  -  -  -  -  -  -  -
#&gt;        16  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        17  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        18  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        19  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        20  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        21  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        22  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt;        23  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
#&gt; 
#&gt; Age agreement table symmetry test results
#&gt;       symTest df   chi.sq            p
#&gt; 1     McNemar  1 51.57851 6.879037e-13
#&gt; 2 EvansHoenig 10 62.46849 1.232555e-09
#&gt; 3      Bowker 54 75.97662 2.598188e-02</div><div class='input'><span class='co'># flip table (easy to compare to age bias plot) and show zeroes (not dashes)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ab1</span>,what<span class='op'>=</span><span class='st'>"table"</span>,flip.table<span class='op'>=</span><span class='cn'>TRUE</span>,zero.print<span class='op'>=</span><span class='st'>"0"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          Otolith Age
#&gt; Scale Age  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
#&gt;        23  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        22  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        21  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        20  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        19  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        18  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        17  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        16  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        15  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0
#&gt;        14  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  0
#&gt;        13  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  1  1  0  0  0  0  0
#&gt;        12  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  1  0  0  0  0  0  0  0
#&gt;        11  0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  2  0  0  0  0  0  0
#&gt;        10  0  0  0  0  0  0  1  0  0  0  0  1  1  0  0  1  0  0  0  0  0  0  1
#&gt;        9   0  0  0  0  0  0  0  0  0  0  1  1  1  0  2  0  1  0  0  0  0  0  0
#&gt;        8   0  0  0  0  1  0  1  1  3  3  3  1  0  0  0  0  0  0  0  0  0  0  0
#&gt;        7   0  0  0  0  0  0  1  3  6  4  2  2  1  1  0  0  0  1  0  0  0  0  0
#&gt;        6   0  0  1  1  2  1  3  4  1  2  1  1  2  1  0  0  0  0  0  0  0  0  0
#&gt;        5   0  1  0  3  2  5  3  4  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        4   0  0  5  7  3  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        3   0  1 10  6  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        2   4  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
#&gt;        1   5  4  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</div><div class='input'>

<span class='co'>#############################################################</span>
<span class='co'>## Differences Plot (inspired by Muir et al. (2008))</span>
<span class='co'># Default (ranges, open circles for sig diffs, marginal hists)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Show CIs for means (with and without ranges)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,show.CI<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,show.CI<span class='op'>=</span><span class='cn'>TRUE</span>,show.range<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># show points (with and without CIs)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,show.CI<span class='op'>=</span><span class='cn'>TRUE</span>,show.range<span class='op'>=</span><span class='cn'>FALSE</span>,show.pts<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,show.range<span class='op'>=</span><span class='cn'>FALSE</span>,show.pts<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Use same symbols for all means (with ranges)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,pch.mean.sig<span class='op'>=</span><span class='fl'>19</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Use same symbols/colors for all means/CIs (without ranges)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,show.range<span class='op'>=</span><span class='cn'>FALSE</span>,show.CI<span class='op'>=</span><span class='cn'>TRUE</span>,pch.mean.sig<span class='op'>=</span><span class='fl'>19</span>,col.CIsig<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Remove histograms</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xHist<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-8.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,yHist<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xHist<span class='op'>=</span><span class='cn'>FALSE</span>,yHist<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Suppress confidence intervals for n &lt; a certain value</span>
<span class='co'>##   must set this in the original ageBias() call</span>
<span class='va'>ab2</span> <span class='op'>&lt;-</span> <span class='fu'>ageBias</span><span class='op'>(</span><span class='va'>scaleC</span><span class='op'>~</span><span class='va'>otolithC</span>,data<span class='op'>=</span><span class='va'>WhitefishLC</span>,min.n.CI<span class='op'>=</span><span class='fl'>8</span>,
               ref.lab<span class='op'>=</span><span class='st'>"Otolith Age"</span>,nref.lab<span class='op'>=</span><span class='st'>"Scale Age"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab2</span>,show.CI<span class='op'>=</span><span class='cn'>TRUE</span>,show.range<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-11.png' alt='' width='700' height='433' /></div><div class='input'>
 
<span class='co'>#############################################################</span>
<span class='co'>## Differences Plot ( inspired by Bland-Altman plots in McBride (2015))</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-12.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Modify axis limits</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>17</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-13.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Add and remove histograms</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xHist<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-14.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xHist<span class='op'>=</span><span class='cn'>TRUE</span>,yHist<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-15.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,yHist<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-16.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#############################################################</span>
<span class='co'>## Adding post hoc analyses to the main plot</span>
<span class='co'># get original graphing parameters to be reset at the end</span>
<span class='va'>op</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>no.readonly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># get raw data</span>
<span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='va'>ab1</span><span class='op'>$</span><span class='va'>d</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   scaleC otolithC diff mean
#&gt; 1      3        3    0  3.0
#&gt; 2      4        3    1  3.5
#&gt; 3      6        3    3  4.5
#&gt; 4      4        3    1  3.5
#&gt; 5      3        3    0  3.0
#&gt; 6      4        6   -2  5.0</div><div class='input'>
<span class='co'># Add mean difference (w/ approx. 95% CI)</span>
<span class='va'>bias</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>diff</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.96</span>,<span class='fl'>0</span>,<span class='fl'>1.96</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='se.html'>se</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>diff</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>17</span><span class='op'>)</span>,allowAdd<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='va'>bias</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-17.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>

<span class='co'># Same as above, but without marginal histogram, and with</span>
<span class='co'>#   95% agreement lines as well (1.96SDs)</span>
<span class='co'>#   (this is nearly a replicate of a Bland-Altman plot)</span>
<span class='va'>bias</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>diff</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.96</span>,<span class='fl'>0</span>,<span class='fl'>1.96</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='se.html'>se</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>diff</span><span class='op'>)</span>
<span class='va'>agline</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>diff</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.96</span>,<span class='fl'>1.96</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>diff</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,yHist<span class='op'>=</span><span class='cn'>FALSE</span>,allowAdd<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='va'>bias</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='va'>agline</span>,lty<span class='op'>=</span><span class='fl'>3</span>,lwd<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-18.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>

<span class='co'># Add linear regression line of differences on means (w/ approx. 95% CI)</span>
<span class='va'>lm1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>diff</span><span class='op'>~</span><span class='va'>mean</span>,data<span class='op'>=</span><span class='va'>tmp</span><span class='op'>)</span>
<span class='va'>xval</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>19</span>,<span class='fl'>0.1</span><span class='op'>)</span>
<span class='va'>pred1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lm1</span>,<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='va'>xval</span><span class='op'>)</span>,interval<span class='op'>=</span><span class='st'>"confidence"</span><span class='op'>)</span>
<span class='va'>bias1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>xval</span>,<span class='va'>pred1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>bias1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   xval      fit       lwr      upr
#&gt; 1  0.0 1.261964 0.6232456 1.900682
#&gt; 2  0.1 1.217797 0.5861659 1.849428
#&gt; 3  0.2 1.173630 0.5490612 1.798199
#&gt; 4  0.3 1.129463 0.5119307 1.746995
#&gt; 5  0.4 1.085296 0.4747735 1.695819
#&gt; 6  0.5 1.041129 0.4375887 1.644670</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>17</span><span class='op'>)</span>,allowAdd<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>lwr</span><span class='op'>~</span><span class='va'>xval</span>,data<span class='op'>=</span><span class='va'>bias1</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>upr</span><span class='op'>~</span><span class='va'>xval</span>,data<span class='op'>=</span><span class='va'>bias1</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>~</span><span class='va'>xval</span>,data<span class='op'>=</span><span class='va'>bias1</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-19.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>

<span class='co'># Add loess of differences on means (w/ approx. 95% CI as a polygon)</span>
<span class='va'>lo2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/loess.html'>loess</a></span><span class='op'>(</span><span class='va'>diff</span><span class='op'>~</span><span class='va'>mean</span>,data<span class='op'>=</span><span class='va'>tmp</span><span class='op'>)</span>
<span class='va'>xval</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>mean</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>mean</span><span class='op'>)</span>,<span class='fl'>0.1</span><span class='op'>)</span>
<span class='va'>pred2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lo2</span>,<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='va'>xval</span><span class='op'>)</span>,se<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>bias2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>xval</span>,<span class='va'>pred2</span><span class='op'>)</span>
<span class='va'>bias2</span><span class='op'>$</span><span class='va'>lwr</span> <span class='op'>&lt;-</span> <span class='va'>bias2</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>-</span><span class='fl'>1.96</span><span class='op'>*</span><span class='va'>bias2</span><span class='op'>$</span><span class='va'>se.fit</span>
<span class='va'>bias2</span><span class='op'>$</span><span class='va'>upr</span> <span class='op'>&lt;-</span> <span class='va'>bias2</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>+</span><span class='fl'>1.96</span><span class='op'>*</span><span class='va'>bias2</span><span class='op'>$</span><span class='va'>se.fit</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>bias2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   xval         fit    se.fit residual.scale      df        lwr       upr
#&gt; 1  1.0 -0.16024844 0.5716894       1.887342 145.685 -1.2807597 0.9602628
#&gt; 2  1.1 -0.13313237 0.5396064       1.887342 145.685 -1.1907610 0.9244962
#&gt; 3  1.2 -0.10771932 0.5091066       1.887342 145.685 -1.1055683 0.8901296
#&gt; 4  1.3 -0.08401421 0.4802391       1.887342 145.685 -1.0252828 0.8572543
#&gt; 5  1.4 -0.06202196 0.4530549       1.887342 145.685 -0.9500096 0.8259657
#&gt; 6  1.5 -0.04174751 0.4276065       1.887342 145.685 -0.8798563 0.7963613</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>17</span><span class='op'>)</span>,allowAdd<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>bias2</span>,<span class='fu'><a href='https://rdrr.io/r/graphics/polygon.html'>polygon</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xval</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>xval</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>lwr</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>upr</span><span class='op'>)</span><span class='op'>)</span>,
                   col<span class='op'>=</span><span class='fu'><a href='col2rgbt.html'>col2rgbt</a></span><span class='op'>(</span><span class='st'>"red"</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span>,border<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>~</span><span class='va'>xval</span>,data<span class='op'>=</span><span class='va'>bias2</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-20.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>
                  
<span class='co'># Same as above, but polygon and line behind the points</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,xvals<span class='op'>=</span><span class='st'>"mean"</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>17</span><span class='op'>)</span>,col.pts<span class='op'>=</span><span class='st'>"white"</span>,allowAdd<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>bias2</span>,<span class='fu'><a href='https://rdrr.io/r/graphics/polygon.html'>polygon</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xval</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>xval</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>lwr</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>upr</span><span class='op'>)</span><span class='op'>)</span>,
                   col<span class='op'>=</span><span class='fu'><a href='col2rgbt.html'>col2rgbt</a></span><span class='op'>(</span><span class='st'>"red"</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span>,border<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>~</span><span class='va'>xval</span>,data<span class='op'>=</span><span class='va'>bias2</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>diff</span><span class='op'>~</span><span class='va'>mean</span>,data<span class='op'>=</span><span class='va'>tmp</span>,pch<span class='op'>=</span><span class='fl'>19</span>,col<span class='op'>=</span><span class='fu'><a href='col2rgbt.html'>col2rgbt</a></span><span class='op'>(</span><span class='st'>"black"</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-21.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>

<span class='co'># Can also be made with the reference ages on the x-axis</span>
<span class='va'>lo3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/loess.html'>loess</a></span><span class='op'>(</span><span class='va'>diff</span><span class='op'>~</span><span class='va'>otolithC</span>,data<span class='op'>=</span><span class='va'>tmp</span><span class='op'>)</span>
<span class='va'>xval</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>otolithC</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>otolithC</span><span class='op'>)</span>,<span class='fl'>0.1</span><span class='op'>)</span>
<span class='va'>pred3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lo3</span>,<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>otolithC<span class='op'>=</span><span class='va'>xval</span><span class='op'>)</span>,se<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>bias3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>xval</span>,<span class='va'>pred3</span><span class='op'>)</span>
<span class='va'>bias3</span><span class='op'>$</span><span class='va'>lwr</span> <span class='op'>&lt;-</span> <span class='va'>bias3</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>-</span><span class='fl'>1.96</span><span class='op'>*</span><span class='va'>bias3</span><span class='op'>$</span><span class='va'>se.fit</span>
<span class='va'>bias3</span><span class='op'>$</span><span class='va'>upr</span> <span class='op'>&lt;-</span> <span class='va'>bias3</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>+</span><span class='fl'>1.96</span><span class='op'>*</span><span class='va'>bias3</span><span class='op'>$</span><span class='va'>se.fit</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ab1</span>,show.range<span class='op'>=</span><span class='cn'>FALSE</span>,show.pts<span class='op'>=</span><span class='cn'>TRUE</span>,col.pts<span class='op'>=</span><span class='st'>"white"</span>,allowAdd<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>bias3</span>,<span class='fu'><a href='https://rdrr.io/r/graphics/polygon.html'>polygon</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xval</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>xval</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>lwr</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>upr</span><span class='op'>)</span><span class='op'>)</span>,
                   col<span class='op'>=</span><span class='fu'><a href='col2rgbt.html'>col2rgbt</a></span><span class='op'>(</span><span class='st'>"red"</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span>,border<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>~</span><span class='va'>xval</span>,data<span class='op'>=</span><span class='va'>bias3</span>,lty<span class='op'>=</span><span class='fl'>2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>diff</span><span class='op'>~</span><span class='va'>otolithC</span>,data<span class='op'>=</span><span class='va'>tmp</span>,pch<span class='op'>=</span><span class='fl'>19</span>,col<span class='op'>=</span><span class='fu'><a href='col2rgbt.html'>col2rgbt</a></span><span class='op'>(</span><span class='st'>"black"</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='ageBias-22.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Derek Ogle, Jason Doll, Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


