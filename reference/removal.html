<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Population estimates for k-, 3-, or 2-pass removal data. — removal • FSA</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Population estimates for k-, 3-, or 2-pass removal data. — removal" />
<meta property="og:description" content="Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population." />
<meta property="og:image" content="http://derekogle.com/FSA/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FSA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/droglenc/FSA">
    <span class="fas fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Population estimates for k-, 3-, or 2-pass removal data.</h1>
    <small class="dont-index">Source: <a href='https://github.com/droglenc/FSA/blob/master/R/removal.R'><code>R/removal.R</code></a></small>
    <div class="hidden name"><code>removal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population.</p>
    </div>

    <pre class="usage"><span class='fu'>removal</span><span class='op'>(</span>
  <span class='va'>catch</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CarleStrub"</span>, <span class='st'>"Zippin"</span>, <span class='st'>"Seber3"</span>, <span class='st'>"Seber2"</span>, <span class='st'>"RobsonRegier2"</span>, <span class='st'>"Moran"</span>,
    <span class='st'>"Schnute"</span>, <span class='st'>"Burnham"</span><span class='op'>)</span>,
  alpha <span class='op'>=</span> <span class='fl'>1</span>,
  beta <span class='op'>=</span> <span class='fl'>1</span>,
  CS.se <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Zippin"</span>, <span class='st'>"alternative"</span><span class='op'>)</span>,
  conf.level <span class='op'>=</span> <span class='fl'>0.95</span>,
  just.ests <span class='op'>=</span> <span class='cn'>FALSE</span>,
  Tmult <span class='op'>=</span> <span class='fl'>3</span>,
  CIMicroFish <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S3 method for removal</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  parm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No"</span>, <span class='st'>"p"</span>, <span class='st'>"p1"</span><span class='op'>)</span>,
  digits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"digits"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for removal</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  parm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No"</span>, <span class='st'>"p"</span><span class='op'>)</span>,
  level <span class='op'>=</span> <span class='va'>conf.level</span>,
  conf.level <span class='op'>=</span> <span class='cn'>NULL</span>,
  digits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"digits"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>catch</th>
      <td><p>A numerical vector of catch at each pass.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A single string that identifies the removal method to use. See details.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>A single numeric value for the alpha parameter in the CarleStrub method (default is <code>1</code>).</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>A single numeric value for the beta parameter in the CarleStrub method (default is <code>1</code>).</p></td>
    </tr>
    <tr>
      <th>CS.se</th>
      <td><p>A single string that identifies whether the SE in the CarleStrub method should be computed according to Seber or Zippin.</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>A single number representing the level of confidence to use for constructing confidence intervals. This is sent in the main <code>removal</code> function rather than <code>confint</code>.</p></td>
    </tr>
    <tr>
      <th>just.ests</th>
      <td><p>A logical that indicates whether just the estimates (<code>=TRUE</code>) or the return list (<code>=FALSE</code>; default; see below) is returned.</p></td>
    </tr>
    <tr>
      <th>Tmult</th>
      <td><p>A single numeric that will be multiplied by the total catch in all samples to set the upper value for the range of population sizes when minimizing the log-likelihood and creating confidence intervals for the Moran and Schnute methods. Large values are much slower to compute, but values that are too low may result in missing the best estimate. A warning is issued if too low of a value is suspected.</p></td>
    </tr>
    <tr>
      <th>CIMicroFish</th>
      <td><p>A logical that indicates whether the t value used to calculate confidence intervals when <code>method="Burnham"</code> should be rounded to two or three decimals and whether the confidence intervals for No should be rounded to whole numbers as done in MicroFish 3.0. The default (<code>=FALSE</code>) is to NOT round the t values or No confidence interval. This option is provided only so that results will exactly match MicroFish results (see testing).</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>An object saved from <code>removal()</code>.</p></td>
    </tr>
    <tr>
      <th>parm</th>
      <td><p>A specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>A single numeric that controls the number of decimals in the output from <code>summary</code> and <code>confint</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical that indicates whether descriptive labels should be printed from <code>summary</code> and if certain warnings are shown with <code>confint</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for methods.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Not used, but here for compatibility with generic <code>confint</code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector that contains the estimates and standard errors for No and p if <code>just.ests=TRUE</code> or (default) a list with at least the following items:</p><ul>
<li><p>catch The original vector of observed catches.</p></li>
<li><p>method The method used (provided by the user).</p></li>
<li><p>lbl A descriptive label for the method used.</p></li>
<li><p>est A matrix that contains the estimates and standard errors for No and p.</p></li>
</ul>

<p>In addition, if the Moran or Schnute methods are used the list will also contain</p><ul>
<li><p>min.nlogLH The minimum value of the negative log-likelihood function.</p></li>
<li><p>Tmult The Tmult value sent by the user.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The main function computes the estimates and associated standard errors, if possible, for the initial population size, No, and probability of capture, p, for eight methods chosen with <code>method=</code>. The possible methods are:</p><ul>
<li><p><code>method="CarleStrub"</code>: The general weighted k-pass estimator proposed by Carle and Strub (1978). This function iteratively solves for No in equation 7 of Carle and Strub (1978).</p></li>
<li><p><code>method="Zippin"</code>: The general k-pass estimator generally attributed to Zippin. This function iteratively solves for No in bias corrected version of equation 3 (page 622) of Carle and Strub (1978). These results are not yet trustworthy (see Testing section below).</p></li>
<li><p><code>method="Seber3"</code>: The special case for k=3 estimator shown in equation 7.24 of Seber(2002).</p></li>
<li><p><code>method="Seber2"</code>: The special case for k=2 estimator shown on page 312 of Seber(2002).</p></li>
<li><p><code>method="RobsonRegier2"</code>: The special case for k=2 estimator shown by Robson and Regier (1968).</p></li>
<li><p><code>method="Moran"</code>: The likelihood method of Moran (1951) as implemented by Schnute (1983).</p></li>
<li><p><code>method="Schnute"</code>: The likelihood method of Schnute (1983) for the model that has a different probability of capture for the first sample but a constant probability of capture for all ensuing samples.</p></li>
<li><p><code>method="Burnham"</code>: The general k-pass estimator likelihood method created by Ken Burnham and presented by Van Deventer and Platts (1983). This method is used in the Microfish software (Van Deventer 1989).</p></li>
</ul>

<p>Confidence intervals for the first five methods are computed using standard large-sample normal distribution theory. Note that the confidence intervals for the 2- and 3-pass special cases are only approximately correct if the estimated population size is greater than 200. If the estimated population size is between 50 and 200 then a 95% CI behaves more like a 90% CI.</p>
<p>Confidence intervals for the next two methods use likelihood ratio theory as described in Schnute (1983) and are only produced for the No parameter. Standard errors are not produced with the Moran or Schnute methods.</p>
<p>Confidence intervals for the last method are computed as per Ken Burnham's instructions for the Burnham Method (Jack Van Deventer, personal communication). Specifically, they are calculated with the t-statistic and No-1 degrees of freedom. Please note that the MicroFish software rounds the t-statistic before it calculates the confidence intervals about No and p. If you need the confidence interals produced by FSA::removal to duplicate MicroFish, please use CIMicroFish=TRUE.</p>
    <h2 class="hasAnchor" id="testing"><a class="anchor" href="#testing"></a>testing</h2>

    <p>The Carle-Strub method matches the examples in Carle and Strub (1978) for No, p, and the variance of No. The Carle-Strub estimates of No and p match the examples in Cowx (1983) but the SE of No does not. The Carle-Strub estimates of No match the results (for estimates that they did not reject) from Jones and Stockwell (1995) to within 1 individual in most instances and within 1% for all other instances (e.g., off by 3 individuals when the estimate was 930 individuals).</p>
<p>The Seber3 results for No match the results in Cowx (1983).</p>
<p>The Seber2 results for No, p, and the SE of No match the results in example 7.4 of Seber (2002) and in Cowx (1983).</p>
<p>The RobsonRegier2 results for No and the SE of NO match the results in Cowx (1983)</p>
<p>The Zippin method results do not match the examples in Seber (2002) or Cowx (1983) because <code>removal</code> uses the bias-corrected version from Carle and Strub (1978) and does not use the tables in Zippin (1958). The Zippin method is not yet trustworthy.</p>
<p>The Moran and Schnute methods match the examples in Schnute (1983) perfectly for all point estimates and within 0.1 units for all confidence intervals.</p>
<p>The Burnham method was tested against the free (gratis) Demo Version of MicroFish 3.0. Powell Wheeler used R to simulate 100, three-pass removal samples with capture probabilities between 0 and 1 and population sizes &lt;= 1000. The Burnham method implemented here exactly matched MicroFish in all 100 trials for No and p. In addition, the CIs for No exactly matched all 100 trials when CIMicroFish=TRUE. Powell was not able to check the CIs for p because the MicroFish 'Quick Population Estimate' does not report them.</p>
    <h2 class="hasAnchor" id="ifar-chapter"><a class="anchor" href="#ifar-chapter"></a>IFAR Chapter</h2>

    <p>10-Abundance from Depletion Data.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ogle, D.H. 2016. <a href='http://derekogle.com/IFAR/'>Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Carle, F.L. and M.R. Strub. 1978. A new method for estimating population size from removal data. Biometrics, 34:621-630.</p>
<p>Cowx, I.G. 1983. Review of the methods for estimating fish population size from survey removal data. Fisheries Management, 14:67-82.</p>
<p>Moran, P.A.P. 1951. A mathematical theory of animal trapping. Biometrika 38:307-311.</p>
<p>Robson, D.S., and H.A. Regier. 1968. Estimation of population number and mortality rates. pp. 124-158 in Ricker, W.E. (editor) Methods for Assessment of Fish Production in Fresh Waters. IBP Handbook NO. 3 Blackwell Scientific Publications, Oxford.</p>
<p>Schnute, J. 1983. A new approach to estimating populations by the removal method. Canadian Journal of Fisheries and Aquatic Sciences, 40:2153-2169.</p>
<p>Seber, G.A.F. 2002. The Estimation of Animal Abundance. Edward Arnold, second edition (Reprint).</p>
<p>van Dishoeck, P. 2009. Effects of catchability variation on performance of depletion estimators: Application to an adaptive management experiment. Masters Thesis, Simon Fraser University. [Was (is?) from http://rem-main.rem.sfu.ca/theses/vanDishoeckPier_2009_MRM483.pdf.]</p>
<p>Van Deventer, J.S. 1989. Microcomputer Software System for Generating Population Statistics from Electrofishing Data--User's Guide for MicroFish 3.0. USDA Forest Service, General Technical Report INT-254. 29 p. [Was (is?) from https://relicensing.pcwa.net/documents/Library/PCWA-L<!-- %20460.pdf]. --></p>
<p>Van Deventer, J.S., and W.S. Platts. 1983. Sampling and estimating fish populations from streams. Transactions of the 48th North American Wildlife and Natural Resource Conference. pp. 349-354.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See <code><a href='depletion.html'>depletion</a></code> for related functionality.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Derek H. Ogle, <a href='mailto:derek@derekogle.com'>derek@derekogle.com</a></p>
<p>A. Powell Wheeler, <a href='mailto:powell.wheeler@gmail.com'>powell.wheeler@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## First example -- 3 passes</span>
<span class='va'>ct3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>77</span>,<span class='fl'>50</span>,<span class='fl'>37</span><span class='op'>)</span>

<span class='co'># Carle Strub (default) method</span>
<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Estimate Std. Error
#&gt; No 233.0000000 31.3578504
#&gt; p    0.3313131  0.0666816</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p1</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Carle &amp; Strub (1978) K-Pass Removal Method was used.</span></div><div class='output co'>#&gt;       Estimate Std. Error
#&gt; No 233.0000000 31.3578504
#&gt; p    0.3313131  0.0666816</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p1</span>,parm<span class='op'>=</span><span class='st'>"No"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Estimate Std. Error
#&gt; No      233   31.35785</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p1</span>,parm<span class='op'>=</span><span class='st'>"p"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Estimate Std. Error
#&gt; p 0.3313131  0.0666816</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        95% LCI     95% UCI
#&gt; No 171.5397426 294.4602574
#&gt; p    0.2006195   0.4620067</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p1</span>,parm<span class='op'>=</span><span class='st'>"No"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     95% LCI  95% UCI
#&gt; No 171.5397 294.4603</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p1</span>,parm<span class='op'>=</span><span class='st'>"p"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     95% LCI   95% UCI
#&gt; p 0.2006195 0.4620067</div><div class='input'>
<span class='co'># Moran method</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct3</span>,method<span class='op'>=</span><span class='st'>"Moran"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p2</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Moran (1951) K-Pass Removal Method was used (SEs not computed).</span></div><div class='output co'>#&gt;       Estimate
#&gt; No 237.5965440
#&gt; p    0.3223336</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p2</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    95% LCI 95% UCI
#&gt; No   194.7   370.9</div><div class='input'><span class='co'>#'</span>
<span class='co'># Schnute method</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct3</span>,method<span class='op'>=</span><span class='st'>"Schnute"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p3</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Schnute (1983) K-Pass Removal Method w/ Non-constant Initial Catchability was used (SEs not computed).</span></div><div class='output co'>#&gt;       Estimate
#&gt; No 245.0955550
#&gt; p    0.3039927
#&gt; p1   0.3141632</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p3</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>An upper confidence value for 'No' cannot be determined.</span></div><div class='output co'>#&gt;    95% LCI 95% UCI
#&gt; No   183.9     Inf</div><div class='input'>
<span class='co'># Burnham method</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct3</span>,method<span class='op'>=</span><span class='st'>"Burnham"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Estimate Std. Error
#&gt; No 238.0000000 33.8404319
#&gt; p    0.3215686  0.0673948</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p4</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Burnham K-Pass Removal Method (Van Deventer and Platts 1983) was used.</span></div><div class='output co'>#&gt;       Estimate Std. Error
#&gt; No 238.0000000 33.8404319
#&gt; p    0.3215686  0.0673948</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p4</span>,parm<span class='op'>=</span><span class='st'>"No"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Estimate Std. Error
#&gt; No      238   33.84043</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p4</span>,parm<span class='op'>=</span><span class='st'>"p"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Estimate Std. Error
#&gt; p 0.3215686  0.0673948</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        95% LCI     95% UCI
#&gt; No 171.3335366 304.6664634
#&gt; p    0.1887992   0.4543381</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p4</span>,parm<span class='op'>=</span><span class='st'>"No"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     95% LCI  95% UCI
#&gt; No 171.3335 304.6665</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p4</span>,parm<span class='op'>=</span><span class='st'>"p"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     95% LCI   95% UCI
#&gt; p 0.1887992 0.4543381</div><div class='input'><span class='co'>## Second example -- 2 passes</span>
<span class='va'>ct2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>77</span>,<span class='fl'>37</span><span class='op'>)</span>

<span class='co'># Seber method</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct2</span>,method<span class='op'>=</span><span class='st'>"Seber2"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p4</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Seber (2002) 2-Pass Removal Method was used.</span></div><div class='output co'>#&gt;       Estimate Std. Error
#&gt; No 148.2250000 19.0118725
#&gt; p    0.5194805  0.0961208</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>p4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        95% LCI     95% UCI
#&gt; No 110.9624147 185.4875853
#&gt; p    0.3310873   0.7078737</div><div class='input'>

<span class='co'>### Test if catchability differs between first sample and the other samples</span>
<span class='co'># chi-square test statistic from  negative log-likelihoods</span>
<span class='co'>#   from Moran and Schnute fits (from above)</span>
<span class='va'>chi2.val</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>*</span><span class='op'>(</span><span class='va'>p2</span><span class='op'>$</span><span class='va'>min.nlogLH</span><span class='op'>-</span><span class='va'>p3</span><span class='op'>$</span><span class='va'>min.nlogLH</span><span class='op'>)</span>
<span class='co'># p-value ... no significant difference</span>
<span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>chi2.val</span>,df<span class='op'>=</span><span class='fl'>1</span>,lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.8882765</div><div class='input'>
<span class='co'># Another LRT example ... sample 1 from Schnute (1983)</span>
<span class='va'>ct4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>45</span>,<span class='fl'>11</span>,<span class='fl'>18</span>,<span class='fl'>8</span><span class='op'>)</span>
<span class='va'>p2a</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct4</span>,method<span class='op'>=</span><span class='st'>"Moran"</span><span class='op'>)</span>
<span class='va'>p3a</span> <span class='op'>&lt;-</span> <span class='fu'>removal</span><span class='op'>(</span><span class='va'>ct4</span>,method<span class='op'>=</span><span class='st'>"Schnute"</span><span class='op'>)</span>
<span class='va'>chi2.val</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>*</span><span class='op'>(</span><span class='va'>p2a</span><span class='op'>$</span><span class='va'>min.nlogLH</span><span class='op'>-</span><span class='va'>p3a</span><span class='op'>$</span><span class='va'>min.nlogLH</span><span class='op'>)</span>  <span class='co'># 4.74 in Schnute(1983)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>chi2.val</span>,df<span class='op'>=</span><span class='fl'>1</span>,lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>         <span class='co'># significant difference (catchability differs)</span>
</div><div class='output co'>#&gt; [1] 0.02955309</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>p3a</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Estimate
#&gt; No 123.5879686
#&gt; p    0.1890032
#&gt; p1   0.3641131</div><div class='input'>

<span class='co'>### Using lapply() to use removal() on many different groups</span>
<span class='co'>###   with the removals in a single variable ("long format")</span>
<span class='co'>## create a dummy data frame</span>
<span class='va'>lake</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Ash Tree"</span>,<span class='st'>"Bark"</span>,<span class='st'>"Clay"</span><span class='op'>)</span>,each<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>year</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2010"</span>,<span class='st'>"2011"</span>,<span class='st'>"2010"</span>,<span class='st'>"2011"</span>,<span class='st'>"2010"</span>,<span class='st'>"2011"</span><span class='op'>)</span>,times<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>pass</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>catch</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>57</span>,<span class='fl'>34</span>,<span class='fl'>65</span>,<span class='fl'>34</span>,<span class='fl'>12</span>,<span class='fl'>54</span>,<span class='fl'>26</span>,<span class='fl'>9</span>,<span class='fl'>54</span>,<span class='fl'>27</span>,<span class='fl'>67</span>,<span class='fl'>34</span>,<span class='fl'>68</span>,<span class='fl'>35</span>,<span class='fl'>12</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>lake</span>,<span class='va'>year</span>,<span class='va'>pass</span>,<span class='va'>catch</span><span class='op'>)</span>

<span class='co'>## create a variable that indicates each different group</span>
<span class='va'>d</span><span class='op'>$</span><span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>d</span>,<span class='fu'><a href='https://rdrr.io/r/base/interaction.html'>interaction</a></span><span class='op'>(</span><span class='va'>lake</span>,<span class='va'>year</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>d</span>
</div><div class='output co'>#&gt;        lake year pass catch         group
#&gt; 1  Ash Tree 2010    1    57 Ash Tree.2010
#&gt; 2  Ash Tree 2010    2    34 Ash Tree.2010
#&gt; 3  Ash Tree 2011    1    65 Ash Tree.2011
#&gt; 4  Ash Tree 2011    2    34 Ash Tree.2011
#&gt; 5  Ash Tree 2011    3    12 Ash Tree.2011
#&gt; 6      Bark 2010    1    54     Bark.2010
#&gt; 7      Bark 2010    2    26     Bark.2010
#&gt; 8      Bark 2010    3     9     Bark.2010
#&gt; 9      Bark 2011    1    54     Bark.2011
#&gt; 10     Bark 2011    2    27     Bark.2011
#&gt; 11     Clay 2010    1    67     Clay.2010
#&gt; 12     Clay 2010    2    34     Clay.2010
#&gt; 13     Clay 2011    1    68     Clay.2011
#&gt; 14     Clay 2011    2    35     Clay.2011
#&gt; 15     Clay 2011    3    12     Clay.2011</div><div class='input'><span class='co'>## split the catch by the different groups (creates a list of catch vectors)</span>
<span class='va'>ds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>$</span><span class='va'>catch</span>,<span class='va'>d</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='co'>## apply removal() to each catch vector (i.e., different group)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>ds</span>,<span class='va'>removal</span>,just.ests<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>res</span>,check.names<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## get rownames from above and split into separate columns</span>
<span class='va'>nms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span><span class='op'>(</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>,<span class='st'>"\\."</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>nms</span>,<span class='st'>"dimnames"</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>fnl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>nms</span>,<span class='va'>res</span><span class='op'>)</span>
<span class='co'>## put names together with values</span>
<span class='fu'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames</a></span><span class='op'>(</span><span class='va'>fnl</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>fnl</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lake"</span>,<span class='st'>"Year"</span><span class='op'>)</span>
<span class='va'>fnl</span>
</div><div class='output co'>#&gt;       Lake Year  No     No.se    No.LCI   No.UCI         p       p.se     p.LCI
#&gt; 1 Ash Tree 2010 130 26.108558  78.82817 181.1718 0.4482759 0.12120594 0.2107166
#&gt; 2     Bark 2010  95  4.247687  86.67469 103.3253 0.5894040 0.06418406 0.4636055
#&gt; 3     Clay 2010 130 17.446161  95.80615 164.1938 0.5233161 0.10171976 0.3239490
#&gt; 4 Ash Tree 2011 121  5.771511 109.68805 132.3120 0.5577889 0.06016508 0.4398676
#&gt; 5     Bark 2011 103 14.760527  74.06990 131.9301 0.5328947 0.11173743 0.3138934
#&gt; 6     Clay 2011 125  5.666291 113.89427 136.1057 0.5637255 0.05857289 0.4489247
#&gt;       p.UCI
#&gt; 1 0.6858351
#&gt; 2 0.7152024
#&gt; 3 0.7226831
#&gt; 4 0.6757103
#&gt; 5 0.7518961
#&gt; 6 0.6785262</div><div class='input'>

<span class='co'>### Using apply() to use removal() on many different groups</span>
<span class='co'>###   with the removals in several variables ("wide format")</span>
<span class='co'>## create a dummy data frame (just reshaped from above as</span>
<span class='co'>## an example; -5 to ignore the group variable from above)</span>
<span class='va'>d1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/reshape.html'>reshape</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span>,timevar<span class='op'>=</span><span class='st'>"pass"</span>,idvar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lake"</span>,<span class='st'>"year"</span><span class='op'>)</span>,direction<span class='op'>=</span><span class='st'>"wide"</span><span class='op'>)</span>
<span class='co'>## apply restore() to each row of only the catch data</span>
<span class='va'>res1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>d1</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>,MARGIN<span class='op'>=</span><span class='fl'>1</span>,FUN<span class='op'>=</span><span class='va'>removal</span>,method<span class='op'>=</span><span class='st'>"CarleStrub"</span>,just.ests<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: 'NA's removed from 'catch' to continue.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'NA's removed from 'catch' to continue.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'NA's removed from 'catch' to continue.</span></div><div class='input'><span class='va'>res1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>res1</span>,check.names<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## add the grouping information to the results</span>
<span class='va'>fnl1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>d1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>,<span class='va'>res1</span><span class='op'>)</span>
<span class='co'>## put names together with values</span>
<span class='fu'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames</a></span><span class='op'>(</span><span class='va'>fnl1</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>fnl1</span>
</div><div class='output co'>#&gt;       lake year  No     No.se    No.LCI   No.UCI         p       p.se     p.LCI
#&gt; 1 Ash Tree 2010 130 26.108558  78.82817 181.1718 0.4482759 0.12120594 0.2107166
#&gt; 2 Ash Tree 2011 121  5.771511 109.68805 132.3120 0.5577889 0.06016508 0.4398676
#&gt; 3     Bark 2010  95  4.247687  86.67469 103.3253 0.5894040 0.06418406 0.4636055
#&gt; 4     Bark 2011 103 14.760527  74.06990 131.9301 0.5328947 0.11173743 0.3138934
#&gt; 5     Clay 2010 130 17.446161  95.80615 164.1938 0.5233161 0.10171976 0.3239490
#&gt; 6     Clay 2011 125  5.666291 113.89427 136.1057 0.5637255 0.05857289 0.4489247
#&gt;       p.UCI
#&gt; 1 0.6858351
#&gt; 2 0.6757103
#&gt; 3 0.7152024
#&gt; 4 0.7518961
#&gt; 5 0.7226831
#&gt; 6 0.6785262</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Derek Ogle, Jason Doll, Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


