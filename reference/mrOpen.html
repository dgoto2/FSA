<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Jolly-Seber analysis from multiple mark-recapture events from an open population. — jolly • FSA</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Jolly-Seber analysis from multiple mark-recapture events from an open population. — jolly" />
<meta property="og:description" content="This function takes the two parts of a Method B table and uses the Jolly-Seber method to estimate the population size at each possible sample period and the apparent survival rate and number of additional individuals added to the population between possible sample periods. This method assumes that the population is open." />
<meta property="og:image" content="http://derekogle.com/FSA/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FSA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/droglenc/FSA">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Jolly-Seber analysis from multiple mark-recapture events from an open population.</h1>
    <small class="dont-index">Source: <a href='https://github.com/droglenc/FSA/blob/master/R/mrOpen.R'><code>R/mrOpen.R</code></a></small>
    <div class="hidden name"><code>mrOpen.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes the two parts of a Method B table and uses the Jolly-Seber method to estimate the population size at each possible sample period and the apparent survival rate and number of additional individuals added to the population between possible sample periods. This method assumes that the population is open.</p>
    </div>

    <pre class="usage"><span class='fu'>jolly</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>

<span class='fu'>mrOpen</span><span class='op'>(</span>
  <span class='va'>mb.top</span>,
  mb.bot <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Jolly"</span>, <span class='st'>"Manly"</span><span class='op'>)</span>,
  conf.level <span class='op'>=</span> <span class='fl'>0.95</span>,
  phi.full <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S3 method for mrOpen</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, parm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"N"</span>, <span class='st'>"phi"</span>, <span class='st'>"B"</span>, <span class='st'>"M"</span><span class='op'>)</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for mrOpen</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  parm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"N"</span>, <span class='st'>"phi"</span>, <span class='st'>"B"</span><span class='op'>)</span>,
  level <span class='op'>=</span> <span class='cn'>NULL</span>,
  conf.level <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for methods.</p></td>
    </tr>
    <tr>
      <th>mb.top</th>
      <td><p>A matrix that contains the &#8220;top&#8221; of the Method B table (i.e., a contingency table of capture sample (columns) and last seen sample (rows)) or an object of class <code>CapHist</code> from <code><a href='capHistSum.html'>capHistSum</a></code>. See details.</p></td>
    </tr>
    <tr>
      <th>mb.bot</th>
      <td><p>A data frame that contains the &#8220;bottom&#8221; of the Method B table (i.e., the number of marked fish in the sample (<code>m</code>), the number of unmarked fish in the sample (<code>u</code>), the total number of fish in the sample (<code>n</code>), and the number of marked fish returned to the population following the sample (<code>R</code>)).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A string that indicates whether the large sample (normal theory) method of Jolly (<code>type="Jolly"</code>) or the &#8220;arbitrary&#8221; method of Manly (<code>type="Manly"</code>) should be used to construct confidence intervals.</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>A single numeric that indicates the level of confidence to use for constructing confidence intervals (default is 0.95). See details.</p></td>
    </tr>
    <tr>
      <th>phi.full</th>
      <td><p>A logical that indicates whether the standard error for phi should include only sampling variability (<code>phi.full=FALSE</code>) or sampling and individual variability (<code>phi.full=TRUE</code>,default).</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>An object from <code>mrOpen</code> (i.e., of class <code>mrOpen</code>).</p></td>
    </tr>
    <tr>
      <th>parm</th>
      <td><p>A string that identifies the model parameters for which to return summaries or confidence intervals. By default, all parameters are returned.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical that indicates if the observables and other notes should be printed in <code>summary</code> and if the type of confidence interval used should be printed in <code>confint</code>. See details.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Same as <code>conf.level</code> but used for compatibility with generic <code>confint</code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following items:</p><ul>
<li><p>df A data frame that contains observable summaries from the data and estimates of the number of extant marked fish  (M), population size for each possible sample period (N), apparent survival rate between each possible pair of sample periods (phi), and the number of additional individuals added to the population between each possible pair of sample periods (B). In addition to the estimates, values of the standard errors and the lower and upper confidence interval bounds for each parameter are provided (however, see the details above).</p></li>
<li><p>type The provided type of confidence intervals that was used.</p></li>
<li><p>phi.full The provided logical that indicates the type of standard error for phi that was used.</p></li>
<li><p>conf.level The provided level of confidence that was used.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>jolly</code> is just a convenience wrapper that produces the exact same results as <code>mrOpen</code>.</p>
<p>If <code>mb.top</code> contains an object from the <code><a href='capHistSum.html'>capHistSum</a></code> function then <code>mb.bot</code> can be left missing. In this case, the function will extract the needed data from the <code>methodB.top</code> and <code>methodB.bot</code> portions of the <code>CapHist</code> class object.</p>
<p>If <code>mb.top</code> is a matrix then it must be square, must have non-negative and no NA values in the upper triangle, and all NA values on the lower triangle and diagonal. If <code>mb.bot</code> is a matrix then it must have four rows named <code>m</code>, <code>u</code>, <code>n</code>, and <code>R</code> (see <code><a href='capHistSum.html'>capHistSum</a></code> for definitions), all values must be non-NA, and the first value of <code>m</code> must be 0. The last value of <code>R</code> can either be 0 or some positive number (it is ultimately ignored in all calculations).</p>
<p>All parameter estimates are performed using equations 4.6-4.9 from Pollock et al (1990) and from page 204 in Seber 2002. If <code>type="Jolly"</code> then all standard errors (square root of the variances) are from equations 4.11, 4.12, and 4.14 in Pollock et al. (1990) (these are different than those in Seber (2002) ... see Pollock et al.'s note on page 21). If <code>type="Jolly"</code> and <code>phi.full=TRUE</code> then the full variance for the phi parameter is given as in eqn 4.18 in Pollock et al. (1990), otherwise eqn 4.13 from Pollock et al. (1990) is used. When <code>type="Jolly"</code> the confidence interval are produced using normal theory (i.e., estimate +/- z*SE). If <code>type="Manly"</code> then the confidence intervals for N and phi (none will be produced for B) are constructed using the methods of Manly (1984) and as described in 2.24-2.33 of Krebs (1989). No standard errors are returned when <code>type="Manly"</code>.</p>
<p>The <code>summary</code> function returns estimates of M, N, phi, B, and their associated standard errors and, if <code>verbose=TRUE</code> the intermediate calculations of &#8220;observables&#8221; from the data -- n, m, R, r, and z.</p>
<p>The level of confidence is not set in the <code>confint</code> function, in contrast to most <code>confint</code> functions. Rather the confidence level is set in the main <code>mrOpen</code> function.</p>
    <h2 class="hasAnchor" id="testing"><a class="anchor" href="#testing"></a>Testing</h2>

    <p>The formulas have been triple-checked against formulas in Pollock et al. (1990), Manly (1984), and Seber (2002).</p>
<p>The results for the <code><a href='CutthroatAL.html'>CutthroatAL</a></code> data file (as analyzed in the example) was compared to results from the JOLLY program available at http://www.mbr-pwrc.usgs.gov/software/jolly.html. The r and z values matched, all M and N estimates match at one decimal place, all phi are within 0.001, and all B are within 0.7. The SE match for M except for two estimates that are within 0.1, match for N except for one estimate that is within 0.1, are within 0.001 for phi, and are within 1.3 for B (except for for the first estimate which is dramatically off).</p>
<p>The results of <code>mrOpen</code> related to Table 4.4 of Pollock et al. (1990) match (to one decimal place) except for three estimates that are within 0.1% for N, match (to two decimal places) for phi except for where Pollock set phi&gt;1 to phi=1, match for B except for Pollock set B&lt;0 to B=0. The SE match (to two decimal places) for N except for N15 (which is within 0.5, &lt;5%), match (to three decimal places) for phi except for phi15 (which is within 0.001, &lt;0.5%), match (to two decimal places) for B except for B17 and B20 which are within 0.2 (&lt;0.2%)</p>
<p>All point estimates of M, N, phi, and B and the SE of phi match the results in Table 2.3 of Krebs (1989) (within minimal rounding error for a very small number of results). The SE of N results are not close to those of Krebs (1989) (who does not provide a formula for SE so the discrepancy cannot be explored). The SE of B results match those of Krebs (1989) for 5 of the 8 values and are within 5% for 2 of the other 3 values (the last estimate is off by 27%).</p>
<p>For comparing to Jolly's data as presented in Tables 5.1 and 5.2 of Seber (2002), M was within 4 (less than 1.5%), N was within 3% (except N2 which was within 9%), phi was within 0.01 (less than 1.5<!-- %), and B was within 7 (less than 5\%) except for B2 and B8. --></p>
    <h2 class="hasAnchor" id="ifar-chapter"><a class="anchor" href="#ifar-chapter"></a>IFAR Chapter</h2>

    <p>9-Abundance from Capture-Recapture Data and 11-Mortality.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ogle, D.H. 2016. <a href='http://derekogle.com/IFAR/'>Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Jolly, G.M. 1965. Explicit estimates from capture-recapture data with both death and immigration -- stochastic model. Biometrika, 52:225-247.</p>
<p>Krebs, C.J. 1989. Ecological Methodology. Harper &amp; Row Publishers, New York.</p>
<p>Leslie, P.H. and D. Chitty. 1951. The estimation of population parameters from data obtained by means of the capture-recapture method. I. The maximum likelihood equations for estimating the death-rate. Biometrika, 38:269-292.</p>
<p>Manly, B.F.J. 1984. Obtaining confidence limits on parameters of the Jolly-Seber model for capture-recapture data. Biometrics, 40:749-758.</p>
<p>Pollock, K.H., J.D. Nichols, C. Brownie, and J.E. Hines. 1991. Statistical inference for capture-recapture experiments. Wildlife Monographs, 107:1-97.</p>
<p>Seber, G.A.F. 1965. A note on the multiple recapture census. Biometrika 52:249-259.</p>
<p>Seber, G.A.F. 2002. The Estimation of Animal Abundance. Edward Arnold, second edition (reprinted).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='capHistSum.html'>capHistSum</a></code>, <code><a href='mrClosed.html'>mrClosed</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Derek H. Ogle, <a href='mailto:derek@derekogle.com'>derek@derekogle.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## First example -- capture histories summarized with capHistSum()</span>
<span class='va'>ch1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='capHistSum.html'>capHistSum</a></span><span class='op'>(</span><span class='va'>CutthroatAL</span>,cols2use<span class='op'>=</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>  <span class='co'># ignore first column of fish ID</span>
<span class='va'>ex1</span> <span class='op'>&lt;-</span> <span class='fu'>mrOpen</span><span class='op'>(</span><span class='va'>ch1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ex1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         M M.se     N  N.se   phi phi.se     B  B.se
#&gt; i=1    NA   NA    NA    NA 0.411  0.088    NA    NA
#&gt; i=2  36.6  6.4 561.1 117.9 0.349  0.045 198.6  48.2
#&gt; i=3 127.8 13.4 394.2  44.2 0.370  0.071 526.3 119.7
#&gt; i=4 120.7 20.8 672.2 138.8 0.218  0.031 154.1  30.2
#&gt; i=5  68.3  4.1 301.0  21.8 0.437  0.041 304.7  25.4
#&gt; i=6 117.6  7.3 436.1  30.3 0.451  0.069 357.2  61.2
#&gt; i=7 175.1 24.6 553.7  84.3 0.268  0.072 106.9  36.2
#&gt; i=8 100.2 24.7 255.3  65.4    NA     NA    NA    NA
#&gt; i=9    NA   NA    NA    NA    NA     NA    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ex1</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Observables:
#&gt;      m   n   R   r  z
#&gt; i=1  0  89  89  26 NA
#&gt; i=2 22 352 352  96  4
#&gt; i=3 94 292 292  51  6
#&gt; i=4 41 233 233  46 16
#&gt; i=5 58 259 259 100  4
#&gt; i=6 99 370 370  99  5
#&gt; i=7 91 290 290  44 13
#&gt; i=8 52 134 134  13  5
#&gt; i=9 18 140   0  NA NA
#&gt; 
#&gt; Estimates (phi.se includes sampling and individual variability):</div><div class='output co'>#&gt;         M M.se     N  N.se   phi phi.se     B  B.se
#&gt; i=1    NA   NA    NA    NA 0.411  0.088    NA    NA
#&gt; i=2  36.6  6.4 561.1 117.9 0.349  0.045 198.6  48.2
#&gt; i=3 127.8 13.4 394.2  44.2 0.370  0.071 526.3 119.7
#&gt; i=4 120.7 20.8 672.2 138.8 0.218  0.031 154.1  30.2
#&gt; i=5  68.3  4.1 301.0  21.8 0.437  0.041 304.7  25.4
#&gt; i=6 117.6  7.3 436.1  30.3 0.451  0.069 357.2  61.2
#&gt; i=7 175.1 24.6 553.7  84.3 0.268  0.072 106.9  36.2
#&gt; i=8 100.2 24.7 255.3  65.4    NA     NA    NA    NA
#&gt; i=9    NA   NA    NA    NA    NA     NA    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ex1</span>,parm<span class='op'>=</span><span class='st'>"N"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         N  N.se
#&gt; i=1    NA    NA
#&gt; i=2 561.1 117.9
#&gt; i=3 394.2  44.2
#&gt; i=4 672.2 138.8
#&gt; i=5 301.0  21.8
#&gt; i=6 436.1  30.3
#&gt; i=7 553.7  84.3
#&gt; i=8 255.3  65.4
#&gt; i=9    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ex1</span>,parm<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"N"</span>,<span class='st'>"phi"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         N  N.se   phi phi.se
#&gt; i=1    NA    NA 0.411  0.088
#&gt; i=2 561.1 117.9 0.349  0.045
#&gt; i=3 394.2  44.2 0.370  0.071
#&gt; i=4 672.2 138.8 0.218  0.031
#&gt; i=5 301.0  21.8 0.437  0.041
#&gt; i=6 436.1  30.3 0.451  0.069
#&gt; i=7 553.7  84.3 0.268  0.072
#&gt; i=8 255.3  65.4    NA     NA
#&gt; i=9    NA    NA    NA     NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>ex1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     N.lci N.uci phi.lci phi.uci B.lci B.uci
#&gt; i=1    NA    NA   0.237   0.584    NA    NA
#&gt; i=2 330.0 792.1   0.261   0.436 104.0 293.1
#&gt; i=3 307.6 480.8   0.231   0.509 291.7 760.8
#&gt; i=4 400.2 944.2   0.159   0.278  95.0 213.2
#&gt; i=5 258.3 343.6   0.356   0.517 254.9 354.6
#&gt; i=6 376.7 495.5   0.316   0.585 237.2 477.3
#&gt; i=7 388.4 719.1   0.127   0.409  36.0 177.8
#&gt; i=8 127.2 383.4      NA      NA    NA    NA
#&gt; i=9    NA    NA      NA      NA    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>ex1</span>,parm<span class='op'>=</span><span class='st'>"N"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     N.lci N.uci
#&gt; i=1    NA    NA
#&gt; i=2 330.0 792.1
#&gt; i=3 307.6 480.8
#&gt; i=4 400.2 944.2
#&gt; i=5 258.3 343.6
#&gt; i=6 376.7 495.5
#&gt; i=7 388.4 719.1
#&gt; i=8 127.2 383.4
#&gt; i=9    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>ex1</span>,parm<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"N"</span>,<span class='st'>"phi"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     N.lci N.uci phi.lci phi.uci
#&gt; i=1    NA    NA   0.237   0.584
#&gt; i=2 330.0 792.1   0.261   0.436
#&gt; i=3 307.6 480.8   0.231   0.509
#&gt; i=4 400.2 944.2   0.159   0.278
#&gt; i=5 258.3 343.6   0.356   0.517
#&gt; i=6 376.7 495.5   0.316   0.585
#&gt; i=7 388.4 719.1   0.127   0.409
#&gt; i=8 127.2 383.4      NA      NA
#&gt; i=9    NA    NA      NA      NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>ex1</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Jolly method was used to construct confidence intervals.</span></div><div class='output co'>#&gt;     N.lci N.uci phi.lci phi.uci B.lci B.uci
#&gt; i=1    NA    NA   0.237   0.584    NA    NA
#&gt; i=2 330.0 792.1   0.261   0.436 104.0 293.1
#&gt; i=3 307.6 480.8   0.231   0.509 291.7 760.8
#&gt; i=4 400.2 944.2   0.159   0.278  95.0 213.2
#&gt; i=5 258.3 343.6   0.356   0.517 254.9 354.6
#&gt; i=6 376.7 495.5   0.316   0.585 237.2 477.3
#&gt; i=7 388.4 719.1   0.127   0.409  36.0 177.8
#&gt; i=8 127.2 383.4      NA      NA    NA    NA
#&gt; i=9    NA    NA      NA      NA    NA    NA</div><div class='input'>
<span class='co'>## Second example - Jolly's data -- summarized data entered "by hand"</span>
<span class='va'>s1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>13</span><span class='op'>)</span>
<span class='va'>s2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>34</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>11</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>18</span>,<span class='fl'>33</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>13</span>,<span class='fl'>30</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>8</span>,<span class='fl'>20</span>,<span class='fl'>43</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s7</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span>,<span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>34</span>,<span class='fl'>56</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s8</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>4</span>,<span class='fl'>0</span>,<span class='fl'>3</span>,<span class='fl'>14</span>,<span class='fl'>19</span>,<span class='fl'>46</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s9</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>2</span>,<span class='fl'>11</span>,<span class='fl'>12</span>,<span class='fl'>28</span>,<span class='fl'>51</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>17</span>,<span class='fl'>22</span>,<span class='fl'>34</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s11</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>4</span>,<span class='fl'>8</span>,<span class='fl'>12</span>,<span class='fl'>16</span>,<span class='fl'>30</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>s12</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>7</span>,<span class='fl'>4</span>,<span class='fl'>11</span>,<span class='fl'>16</span>,<span class='fl'>26</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span><span class='op'>)</span>
<span class='va'>s13</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>10</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>18</span>,<span class='fl'>35</span>,<span class='cn'>NA</span><span class='op'>)</span>
<span class='va'>jolly.top</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>s1</span>,<span class='va'>s2</span>,<span class='va'>s3</span>,<span class='va'>s4</span>,<span class='va'>s5</span>,<span class='va'>s6</span>,<span class='va'>s7</span>,<span class='va'>s8</span>,<span class='va'>s9</span>,<span class='va'>s10</span>,<span class='va'>s11</span>,<span class='va'>s12</span>,<span class='va'>s13</span><span class='op'>)</span>

<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>54</span>,<span class='fl'>146</span>,<span class='fl'>169</span>,<span class='fl'>209</span>,<span class='fl'>220</span>,<span class='fl'>209</span>,<span class='fl'>250</span>,<span class='fl'>176</span>,<span class='fl'>172</span>,<span class='fl'>127</span>,<span class='fl'>123</span>,<span class='fl'>120</span>,<span class='fl'>142</span><span class='op'>)</span>
<span class='va'>R</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>54</span>,<span class='fl'>143</span>,<span class='fl'>164</span>,<span class='fl'>202</span>,<span class='fl'>214</span>,<span class='fl'>207</span>,<span class='fl'>243</span>,<span class='fl'>175</span>,<span class='fl'>169</span>,<span class='fl'>126</span>,<span class='fl'>120</span>,<span class='fl'>120</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>37</span>,<span class='fl'>56</span>,<span class='fl'>53</span>,<span class='fl'>77</span>,<span class='fl'>112</span>,<span class='fl'>86</span>,<span class='fl'>110</span>,<span class='fl'>84</span>,<span class='fl'>77</span>,<span class='fl'>72</span>,<span class='fl'>95</span><span class='op'>)</span>
<span class='va'>u</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>-</span><span class='va'>m</span>
<span class='va'>jolly.bot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>m</span>,<span class='va'>u</span>,<span class='va'>n</span>,<span class='va'>R</span><span class='op'>)</span>

<span class='va'>ex2</span> <span class='op'>&lt;-</span> <span class='fu'>mrOpen</span><span class='op'>(</span><span class='va'>jolly.top</span>,<span class='va'>jolly.bot</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ex2</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Observables:
#&gt;      m   n   R   r   z
#&gt; 1    0  54  54  24  NA
#&gt; 2   10 146 143  80  14
#&gt; 3   37 169 164  70  57
#&gt; 4   56 209 202  71  71
#&gt; 5   53 220 214 109  89
#&gt; 6   77 209 207 101 121
#&gt; 7  112 250 243 108 110
#&gt; 8   86 176 175  99 132
#&gt; 9  110 172 169  70 121
#&gt; 10  84 127 126  58 107
#&gt; 11  77 123 120  44  88
#&gt; 12  72 120 120  35  60
#&gt; 13  95 142   0  NA  NA
#&gt; 
#&gt; Estimates (phi.se includes sampling and individual variability):</div><div class='output co'>#&gt;        M M.se     N  N.se   phi phi.se     B  B.se
#&gt; 1     NA   NA    NA    NA 0.646  0.110    NA    NA
#&gt; 2   34.9  4.8 466.2 133.3 1.009  0.110 290.5 164.3
#&gt; 3  169.5 17.9 758.1 125.6 0.864  0.107 293.0 134.2
#&gt; 4  256.2 27.1 943.8 137.7 0.564  0.063 400.2 118.1
#&gt; 5  227.0 17.4 928.8 120.2 0.834  0.074 101.5 110.0
#&gt; 6  323.7 23.8 871.6  93.9 0.790  0.071 109.2  74.0
#&gt; 7  358.2 24.9 795.7  72.0 0.651  0.057 134.4  54.7
#&gt; 8  318.3 20.4 647.6  59.3 0.981  0.096 -11.6  52.4
#&gt; 9  399.7 33.3 623.0  60.1 0.685  0.081  48.5  34.2
#&gt; 10 314.3 27.6 473.3  48.8 0.880  0.121  82.8  39.1
#&gt; 11 313.6 34.9 498.6  63.0 0.767  0.128  73.3  39.0
#&gt; 12 273.7 36.2 453.6  66.6    NA     NA    NA    NA
#&gt; 13    NA   NA    NA    NA    NA     NA    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>ex2</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The Jolly method was used to construct confidence intervals.</span></div><div class='output co'>#&gt;    N.lci  N.uci phi.lci phi.uci  B.lci B.uci
#&gt; 1     NA     NA   0.430   0.862     NA    NA
#&gt; 2  205.0  727.5   0.793   1.226  -31.4 612.5
#&gt; 3  512.0 1004.3   0.654   1.074   30.0 556.0
#&gt; 4  673.9 1213.8   0.441   0.687  168.8 631.6
#&gt; 5  693.2 1164.5   0.689   0.980 -114.1 317.1
#&gt; 6  687.6 1055.7   0.650   0.929  -35.8 254.1
#&gt; 7  654.6  936.8   0.538   0.763   27.3 241.6
#&gt; 8  531.3  763.9   0.794   1.169 -114.2  91.1
#&gt; 9  505.2  740.8   0.526   0.844  -18.6 115.6
#&gt; 10 377.6  569.0   0.644   1.116    6.2 159.5
#&gt; 11 375.1  622.0   0.516   1.019   -3.2 149.8
#&gt; 12 323.1  584.1      NA      NA     NA    NA
#&gt; 13    NA     NA      NA      NA     NA    NA</div><div class='input'>
<span class='va'>ex3</span> <span class='op'>&lt;-</span> <span class='fu'>mrOpen</span><span class='op'>(</span><span class='va'>jolly.top</span>,<span class='va'>jolly.bot</span>,type<span class='op'>=</span><span class='st'>"Manly"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ex3</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Observables:
#&gt;      m   n   R   r   z
#&gt; 1    0  54  54  24  NA
#&gt; 2   10 146 143  80  14
#&gt; 3   37 169 164  70  57
#&gt; 4   56 209 202  71  71
#&gt; 5   53 220 214 109  89
#&gt; 6   77 209 207 101 121
#&gt; 7  112 250 243 108 110
#&gt; 8   86 176 175  99 132
#&gt; 9  110 172 169  70 121
#&gt; 10  84 127 126  58 107
#&gt; 11  77 123 120  44  88
#&gt; 12  72 120 120  35  60
#&gt; 13  95 142   0  NA  NA
#&gt; 
#&gt; Estimates (phi.se includes sampling and individual variability):</div><div class='output co'>#&gt;        M     N   phi     B
#&gt; 1     NA    NA 0.646    NA
#&gt; 2   34.9 466.2 1.009 290.5
#&gt; 3  169.5 758.1 0.864 293.0
#&gt; 4  256.2 943.8 0.564 400.2
#&gt; 5  227.0 928.8 0.834 101.5
#&gt; 6  323.7 871.6 0.790 109.2
#&gt; 7  358.2 795.7 0.651 134.4
#&gt; 8  318.3 647.6 0.981 -11.6
#&gt; 9  399.7 623.0 0.685  48.5
#&gt; 10 314.3 473.3 0.880  82.8
#&gt; 11 313.6 498.6 0.767  73.3
#&gt; 12 273.7 453.6    NA    NA
#&gt; 13    NA    NA    NA    NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>ex3</span>,verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Manly did not provide a method for constructing confidence intervals for B.</span></div><div class='output co'>#&gt; <span class='message'>The Manly method was used to construct confidence intervals.</span></div><div class='output co'>#&gt;    N.lci  N.uci phi.lci phi.uci
#&gt; 1     NA     NA   0.389   0.783
#&gt; 2  301.3  979.4   0.705   1.100
#&gt; 3  564.0 1210.0   0.627   1.028
#&gt; 4  725.2 1427.8   0.422   0.658
#&gt; 5  731.0 1353.0   0.629   0.901
#&gt; 6  703.2 1219.3   0.602   0.866
#&gt; 7  663.3 1060.8   0.499   0.712
#&gt; 8  529.5  888.6   0.741   1.094
#&gt; 9  506.4  863.4   0.513   0.821
#&gt; 10 375.7  681.9   0.638   1.096
#&gt; 11 384.5  751.9   0.535   1.034
#&gt; 12 342.0  712.0      NA      NA
#&gt; 13    NA     NA      NA      NA</div><div class='input'>
<span class='co'>## demonstrate use of jolly()</span>
<span class='va'>ex3a</span> <span class='op'>&lt;-</span> <span class='fu'>jolly</span><span class='op'>(</span><span class='va'>jolly.top</span>,<span class='va'>jolly.bot</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Derek Ogle, Jason Doll, Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


